<script>
    var killed = 0;
    var titles = {
        0: 'Kill Images',
        1: 'Restore Images'
    };
    var icons = {
        0: 'images/icon32.png',
        1: 'images/restore32.png'
    };
    // Set the initial state
    chrome.browserAction.setTitle({title: titles[killed]});
    chrome.browserAction.setIcon({path: icons[killed]});
    // Handle clicks
    chrome.browserAction.onClicked.addListener(function(tab) {
        // If we're already killed, refresh the tab
        if (killed) {
            chrome.tabs.update(tab.id, { url: tab.url });
        // Otherwise, kill the images
        } else {
            chrome.tabs.insertCSS(null, { file: 'css/kill.css' });
        }
        killed = killed ? 0 : 1;
        chrome.browserAction.setTitle({title: titles[killed]});
        chrome.browserAction.setIcon({path: icons[killed]});
    });
</script>
